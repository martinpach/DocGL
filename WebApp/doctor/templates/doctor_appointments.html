<div class="row doctor-appointments">
        <h1 class="heading" id="heading">Appointments</h1>
    <div class="row">
        <div class="app-menu">
            <input type="text" class="form-control datepicker" placeholder="day" id="day-input">
            <div class="btn-group" data-toggle="buttons">
                <label class="btn btn-primary active">
                    <input type="radio" name="time_period" value="day" autocomplete="off" checked>Selected Day
                </label>
                <label class="btn btn-primary">
                    <input type="radio" name="time_period" value="week" autocomplete="off">One week from the selected Day
                </label>
            </div>
        </div>
    </div>
</div>
<div class="container contentTab z-depth-1" id="contentTab">
</div>
<div id="appointmentModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header text-center">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title headingModal">Appointment details</h4>
            </div>
            <div class="modal-body">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Done</button>
            </div>
        </div>
    </div>
</div>

<script>
    var appointments;
    var radioBtn = $('input[type=radio][name=time_period]');

    $(radioBtn).change(function() {
        if ($('#day-input').val() != "") {
            if (this.value == "day") {
        	    $('#contentTab').empty();
                showDayAppointments();
            }
            if (this.value == "week") {
                $('#contentTab').empty();
                console.log("week");
            }
        }
    });
    $('#day-input').change(function() {
        console.log("sadas");
        if ($('input[type=radio][name=time_period]').val() == "day") {
            $('#contentTab').empty();
            showDayAppointments();
        }
        if ($('input[type=radio][name=time_period]').val() == "week") {
            $('#contentTab').empty();
            console.log("week");
        }
    });
/*
    $('#week-input').change(function() {
        for (var i = 0; i < 7; i++) {
            var appointmentsOnDate = $('<div class="col-md-1">' + i + '</div>');

        }
    });
*/
    function showDayAppointments () {
        ajaxRequest(localStorage.getItem("id"), "appointments?date="+$('#day-input').val()).done(function () {
            for (var i = 0; i < appointments.length; i++) {
            var appointmentBox = $('<div class="appointment-day"></div>');
            var appointmentTimeBox = $('<div class="time"></div>');
            var appointmentPatientBox = $('<div class="patient"></div>');
            var appointmentNoteBox = $('<p class="note"></p>');
            var colMd4 = $('<div class="col-md-4"></div>');
            appointmentTimeBox.text(appointments[i].time);
            appointmentPatientBox.text((appointments[i].patientFirstName == "" ? appointments[i].patient.firstName : appointments[i].patientFirstName) + " " + (appointments[i].patientLastName == "" ? appointments[i].patient.lastName : appointments[i].patientLastName));
            appointmentNoteBox.text(appointments[i].note);
            appointmentBox.append(appointmentTimeBox, appointmentPatientBox, appointmentNoteBox);
            appointmentBox.appendTo(colMd4);
            colMd4.appendTo('#contentTab');
        }
        });
    }


    $(function() {
        $(".datepicker").datepicker({
            dateFormat: "yy-mm-dd"
        });
    });

    function ajaxRequest(id, sufix) {
        var deferred = $.Deferred();
        $.ajax({
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + localStorage.getItem("token"));
            },
            url: 'http://localhost:8085/api/doctors/' + id + '/' + sufix,
            type: 'GET',
            contentType: 'application/json',
            success: function(data) {            
                appointments = data;
                console.log(appointments);
                deferred.resolve();
            },
            error: function() {
                deferred.reject();
            }
        });
        return deferred.promise();
    }
</script>
